<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>IBIsCO: MTS_LOOP.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">IBIsCO
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('MTS__LOOP_8f90.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">MTS_LOOP.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The multiple time step (MTS) subroutines.  
<a href="#details">More...</a></p>

<p><a href="MTS__LOOP_8f90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a5673b4a1685b045fd9770235fb53776f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="MTS__LOOP_8f90.html#a5673b4a1685b045fd9770235fb53776f">mts_loop</a></td></tr>
<tr class="memdesc:a5673b4a1685b045fd9770235fb53776f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The alternate molecular dynamics loop for MTS simulations.  <a href="#a5673b4a1685b045fd9770235fb53776f">More...</a><br/></td></tr>
<tr class="separator:a5673b4a1685b045fd9770235fb53776f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d4911a91ded9ca2f05f4884935c01b8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="MTS__LOOP_8f90.html#a7d4911a91ded9ca2f05f4884935c01b8">mts_force</a> (STEPNO)</td></tr>
<tr class="memdesc:a7d4911a91ded9ca2f05f4884935c01b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">The force loop for MTS simulation.  <a href="#a7d4911a91ded9ca2f05f4884935c01b8">More...</a><br/></td></tr>
<tr class="separator:a7d4911a91ded9ca2f05f4884935c01b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66032ebcaa8d9957fe7a679a53af96ad"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="MTS__LOOP_8f90.html#a66032ebcaa8d9957fe7a679a53af96ad">mts_saveforce</a> (I, BEAD, FX, FY, FZ, NITEMS, MTS_FX, MTS_FY, MTS_FZ, NCOARSE)</td></tr>
<tr class="memdesc:a66032ebcaa8d9957fe7a679a53af96ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Records the coarse grained force from an explicit MTS step.  <a href="#a66032ebcaa8d9957fe7a679a53af96ad">More...</a><br/></td></tr>
<tr class="separator:a66032ebcaa8d9957fe7a679a53af96ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca9f65d2454445481637c63a9505943a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="MTS__LOOP_8f90.html#aca9f65d2454445481637c63a9505943a">mts_approx</a> (I, BEAD, FX, FY, FZ, NITEMS, MTS_FX, MTS_FY, MTS_FZ, NCOARSE)</td></tr>
<tr class="memdesc:aca9f65d2454445481637c63a9505943a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates approximated coarse grained forces for MTS steps.  <a href="#aca9f65d2454445481637c63a9505943a">More...</a><br/></td></tr>
<tr class="separator:aca9f65d2454445481637c63a9505943a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ced222833e8795eefde6ecaf016090a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="MTS__LOOP_8f90.html#a6ced222833e8795eefde6ecaf016090a">mts_saveauxs</a> (I)</td></tr>
<tr class="memdesc:a6ced222833e8795eefde6ecaf016090a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Records the nonbonded potential and pressure tensors from explicit MTS steps.  <a href="#a6ced222833e8795eefde6ecaf016090a">More...</a><br/></td></tr>
<tr class="separator:a6ced222833e8795eefde6ecaf016090a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a33818f78ea9fe4fb159959e6428925"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="MTS__LOOP_8f90.html#a4a33818f78ea9fe4fb159959e6428925">mts_loadauxs</a> (I)</td></tr>
<tr class="memdesc:a4a33818f78ea9fe4fb159959e6428925"><td class="mdescLeft">&#160;</td><td class="mdescRight">Approximates the nonbonded potential and pressure tensors in approximate MTS steps.  <a href="#a4a33818f78ea9fe4fb159959e6428925">More...</a><br/></td></tr>
<tr class="separator:a4a33818f78ea9fe4fb159959e6428925"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The multiple time step (MTS) subroutines. </p>
<p>MTS allows hybrid scale simulations to be ran faster. Normally, hybrid scale simulations are ran using an atomistic time step, which is around an order of magnitude smaller than the native coarse grained counterpart. Using MTS allows the nonbonded coarse grained force to be approximated in some time steps, reducing the computational load.</p>
<p>For further details, see <a class="el" href="citelist.html#CITEREF_MTS">[2]</a></p>
<dl class="section author"><dt>Author</dt><dd>Richard J Gowers </dd></dl>

<p>Definition in file <a class="el" href="MTS__LOOP_8f90_source.html">MTS_LOOP.f90</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a5673b4a1685b045fd9770235fb53776f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mts_loop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The alternate molecular dynamics loop for MTS simulations. </p>

<p>Definition at line <a class="el" href="MTS__LOOP_8f90_source.html#l00013">13</a> of file <a class="el" href="MTS__LOOP_8f90_source.html">MTS_LOOP.f90</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="MTS__LOOP_8f90_a5673b4a1685b045fd9770235fb53776f_cgraph.png" border="0" usemap="#MTS__LOOP_8f90_a5673b4a1685b045fd9770235fb53776f_cgraph" alt=""/></div>
<map name="MTS__LOOP_8f90_a5673b4a1685b045fd9770235fb53776f_cgraph" id="MTS__LOOP_8f90_a5673b4a1685b045fd9770235fb53776f_cgraph">
<area shape="rect" id="node2" href="SHIFT_8f90.html#a2869d2e7ffa63361fddf7544e8b2af7d" title="shift" alt="" coords="175,56,222,83"/><area shape="rect" id="node3" href="VIRTUAL__DEF_8f90.html#a8b2aca5a2b14a74a7eefa9c82862722b" title="virtual_def" alt="" coords="157,107,240,133"/><area shape="rect" id="node4" href="UPDATE__NEIGHBOURLIST_8F90.html#ad9dad469e3448c9a21ce1ad00ac084b7" title="update_neighbourlist" alt="" coords="128,157,269,184"/><area shape="rect" id="node9" href="MTS__LOOP_8f90.html#a7d4911a91ded9ca2f05f4884935c01b8" title="The force loop for MTS simulation. " alt="" coords="159,259,239,285"/><area shape="rect" id="node17" href="MOVE_8F90.html#a72524a568f5553b57c243d5e65d1b446" title="move" alt="" coords="171,309,226,336"/><area shape="rect" id="node18" href="MOMENTUM_8f90.html#a84ee723dc69516d833681a46a8ea2f33" title="momentum" alt="" coords="155,360,242,387"/><area shape="rect" id="node19" href="SCALEBP_8f90.html#afb926d686121999e1aa020e3cd04eefb" title="scalebp" alt="" coords="165,411,232,437"/><area shape="rect" id="node20" href="AVERAGE_8f90.html#adeeb20a43d1fbf2242cd8fa747168e9b" title="average" alt="" coords="165,461,233,488"/><area shape="rect" id="node21" href="WRITETRJ_8f90.html#ad62b7ad0a61aac3f86132c0e63cca31b" title="writetrj" alt="" coords="168,512,229,539"/><area shape="rect" id="node23" href="OUTPUT_8F90.html#a6ad0c96d316568d2f1a87ba098aabb0d" title="output" alt="" coords="169,563,228,589"/><area shape="rect" id="node5" href="MAPS_8f90.html#ae4b0b30c80dc724691e2cb863cd198c1" title="maps" alt="" coords="369,5,423,32"/><area shape="rect" id="node7" href="LINKS_8f90.html#ab836bb1b9d3017862b9dac8197c86fb2" title="links" alt="" coords="371,56,421,83"/><area shape="rect" id="node8" href="NEW__NEIGHBOUR__WITHLIST_8f90.html#a72ed04fb0075578399033643e8c3b3c0" title="new_neighbour_withlist" alt="" coords="317,107,475,133"/><area shape="rect" id="node6" href="MAPS_8f90.html#a9b87887c4e25c8ce1bdc40d39f234b8e" title="icell" alt="" coords="523,5,568,32"/><area shape="rect" id="node10" href="NONBONDED__FORCE_8F90.html#ad1b6e600631fbd8357697b016ef7059c" title="nonbonded_force" alt="" coords="335,157,457,184"/><area shape="rect" id="node11" href="MTS__LOOP_8f90.html#a66032ebcaa8d9957fe7a679a53af96ad" title="Records the coarse grained force from an explicit MTS step. " alt="" coords="342,208,450,235"/><area shape="rect" id="node12" href="MTS__LOOP_8f90.html#a6ced222833e8795eefde6ecaf016090a" title="Records the nonbonded potential and pressure tensors from explicit MTS steps. " alt="" coords="343,259,449,285"/><area shape="rect" id="node13" href="MTS__LOOP_8f90.html#aca9f65d2454445481637c63a9505943a" title="Generates approximated coarse grained forces for MTS steps. " alt="" coords="351,309,441,336"/><area shape="rect" id="node14" href="MTS__LOOP_8f90.html#a4a33818f78ea9fe4fb159959e6428925" title="Approximates the nonbonded potential and pressure tensors in approximate MTS steps. " alt="" coords="345,360,447,387"/><area shape="rect" id="node15" href="DISTRIBUTE__VSFORCE_8f90.html#acdf0634b050e6f8cfc60956dd405e7ac" title="distribute_vsforce" alt="" coords="333,411,459,437"/><area shape="rect" id="node16" href="BONDED__FORCE_8F90.html#ac7a2ab6db611a88045a10088e84479f6" title="bonded_force" alt="" coords="346,461,446,488"/><area shape="rect" id="node22" href="UNIT_8f90.html#a5c29cb83a9a89e0b47ec4f57527ff602" title="unit" alt="" coords="375,512,417,539"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="MTS__LOOP_8f90_a5673b4a1685b045fd9770235fb53776f_icgraph.png" border="0" usemap="#MTS__LOOP_8f90_a5673b4a1685b045fd9770235fb53776f_icgraph" alt=""/></div>
<map name="MTS__LOOP_8f90_a5673b4a1685b045fd9770235fb53776f_icgraph" id="MTS__LOOP_8f90_a5673b4a1685b045fd9770235fb53776f_icgraph">
<area shape="rect" id="node2" href="main_8F90.html#aede99a747ff1a095c7edcbad1119411f" title="ibisco" alt="" coords="128,5,184,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7d4911a91ded9ca2f05f4884935c01b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mts_force </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>STEPNO</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The force loop for MTS simulation. </p>
<p>In this force step, the current step number is used to determine how the coarse grained nonbonded forces are calculated. The first three are done explicitly, then NMTS (an input setting) steps are done using an approximation.</p>
<p>This approximation is a Taylor Expansion</p>
<p>The coarse grained contributions to nonbonded energy (V_NB) and pressure tensors (PTxx) are also estimated in the same fashion.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">stepno</td><td>The current step number </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="MTS__LOOP_8f90_source.html#l00071">71</a> of file <a class="el" href="MTS__LOOP_8f90_source.html">MTS_LOOP.f90</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="MTS__LOOP_8f90_a7d4911a91ded9ca2f05f4884935c01b8_cgraph.png" border="0" usemap="#MTS__LOOP_8f90_a7d4911a91ded9ca2f05f4884935c01b8_cgraph" alt=""/></div>
<map name="MTS__LOOP_8f90_a7d4911a91ded9ca2f05f4884935c01b8_cgraph" id="MTS__LOOP_8f90_a7d4911a91ded9ca2f05f4884935c01b8_cgraph">
<area shape="rect" id="node2" href="NONBONDED__FORCE_8F90.html#ad1b6e600631fbd8357697b016ef7059c" title="nonbonded_force" alt="" coords="135,5,257,32"/><area shape="rect" id="node3" href="MTS__LOOP_8f90.html#a66032ebcaa8d9957fe7a679a53af96ad" title="Records the coarse grained force from an explicit MTS step. " alt="" coords="142,56,250,83"/><area shape="rect" id="node4" href="MTS__LOOP_8f90.html#a6ced222833e8795eefde6ecaf016090a" title="Records the nonbonded potential and pressure tensors from explicit MTS steps. " alt="" coords="143,107,249,133"/><area shape="rect" id="node5" href="MTS__LOOP_8f90.html#aca9f65d2454445481637c63a9505943a" title="Generates approximated coarse grained forces for MTS steps. " alt="" coords="151,157,241,184"/><area shape="rect" id="node6" href="MTS__LOOP_8f90.html#a4a33818f78ea9fe4fb159959e6428925" title="Approximates the nonbonded potential and pressure tensors in approximate MTS steps. " alt="" coords="145,208,247,235"/><area shape="rect" id="node7" href="DISTRIBUTE__VSFORCE_8f90.html#acdf0634b050e6f8cfc60956dd405e7ac" title="distribute_vsforce" alt="" coords="133,259,259,285"/><area shape="rect" id="node8" href="BONDED__FORCE_8F90.html#ac7a2ab6db611a88045a10088e84479f6" title="bonded_force" alt="" coords="146,309,246,336"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="MTS__LOOP_8f90_a7d4911a91ded9ca2f05f4884935c01b8_icgraph.png" border="0" usemap="#MTS__LOOP_8f90_a7d4911a91ded9ca2f05f4884935c01b8_icgraph" alt=""/></div>
<map name="MTS__LOOP_8f90_a7d4911a91ded9ca2f05f4884935c01b8_icgraph" id="MTS__LOOP_8f90_a7d4911a91ded9ca2f05f4884935c01b8_icgraph">
<area shape="rect" id="node2" href="MTS__LOOP_8f90.html#a5673b4a1685b045fd9770235fb53776f" title="The alternate molecular dynamics loop for MTS simulations. " alt="" coords="133,5,208,32"/><area shape="rect" id="node3" href="main_8F90.html#aede99a747ff1a095c7edcbad1119411f" title="ibisco" alt="" coords="256,5,312,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a66032ebcaa8d9957fe7a679a53af96ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mts_saveforce </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ncoarse), intent(in)&#160;</td>
          <td class="paramname"><em>BEAD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(nitems), intent(in)&#160;</td>
          <td class="paramname"><em>FX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(nitems), intent(in)&#160;</td>
          <td class="paramname"><em>FY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(nitems), intent(in)&#160;</td>
          <td class="paramname"><em>FZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NITEMS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(3, ncoarse), intent(inout)&#160;</td>
          <td class="paramname"><em>MTS_FX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(3, ncoarse), intent(inout)&#160;</td>
          <td class="paramname"><em>MTS_FY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(3, ncoarse), intent(inout)&#160;</td>
          <td class="paramname"><em>MTS_FZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NCOARSE</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Records the coarse grained force from an explicit MTS step. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>Mod of current MTS step</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ncoarse</td><td>Total number of particles (real and virtual) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="MTS__LOOP_8f90_source.html#l00145">145</a> of file <a class="el" href="MTS__LOOP_8f90_source.html">MTS_LOOP.f90</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="MTS__LOOP_8f90_a66032ebcaa8d9957fe7a679a53af96ad_icgraph.png" border="0" usemap="#MTS__LOOP_8f90_a66032ebcaa8d9957fe7a679a53af96ad_icgraph" alt=""/></div>
<map name="MTS__LOOP_8f90_a66032ebcaa8d9957fe7a679a53af96ad_icgraph" id="MTS__LOOP_8f90_a66032ebcaa8d9957fe7a679a53af96ad_icgraph">
<area shape="rect" id="node2" href="MTS__LOOP_8f90.html#a7d4911a91ded9ca2f05f4884935c01b8" title="The force loop for MTS simulation. " alt="" coords="163,5,243,32"/><area shape="rect" id="node3" href="MTS__LOOP_8f90.html#a5673b4a1685b045fd9770235fb53776f" title="The alternate molecular dynamics loop for MTS simulations. " alt="" coords="291,5,365,32"/><area shape="rect" id="node4" href="main_8F90.html#aede99a747ff1a095c7edcbad1119411f" title="ibisco" alt="" coords="413,5,469,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aca9f65d2454445481637c63a9505943a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mts_approx </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ncoarse), intent(in)&#160;</td>
          <td class="paramname"><em>BEAD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(nitems), intent(inout)&#160;</td>
          <td class="paramname"><em>FX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(nitems), intent(inout)&#160;</td>
          <td class="paramname"><em>FY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(nitems), intent(inout)&#160;</td>
          <td class="paramname"><em>FZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NITEMS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(3, ncoarse), intent(in)&#160;</td>
          <td class="paramname"><em>MTS_FX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(3, ncoarse), intent(in)&#160;</td>
          <td class="paramname"><em>MTS_FY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=rkind), dimension(3, ncoarse), intent(in)&#160;</td>
          <td class="paramname"><em>MTS_FZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NCOARSE</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates approximated coarse grained forces for MTS steps. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ncoarse</td><td>Total number of particles (real and virtual) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="MTS__LOOP_8f90_source.html#l00171">171</a> of file <a class="el" href="MTS__LOOP_8f90_source.html">MTS_LOOP.f90</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="MTS__LOOP_8f90_aca9f65d2454445481637c63a9505943a_icgraph.png" border="0" usemap="#MTS__LOOP_8f90_aca9f65d2454445481637c63a9505943a_icgraph" alt=""/></div>
<map name="MTS__LOOP_8f90_aca9f65d2454445481637c63a9505943a_icgraph" id="MTS__LOOP_8f90_aca9f65d2454445481637c63a9505943a_icgraph">
<area shape="rect" id="node2" href="MTS__LOOP_8f90.html#a7d4911a91ded9ca2f05f4884935c01b8" title="The force loop for MTS simulation. " alt="" coords="144,5,224,32"/><area shape="rect" id="node3" href="MTS__LOOP_8f90.html#a5673b4a1685b045fd9770235fb53776f" title="The alternate molecular dynamics loop for MTS simulations. " alt="" coords="272,5,347,32"/><area shape="rect" id="node4" href="main_8F90.html#aede99a747ff1a095c7edcbad1119411f" title="ibisco" alt="" coords="395,5,451,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6ced222833e8795eefde6ecaf016090a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mts_saveauxs </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>I</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Records the nonbonded potential and pressure tensors from explicit MTS steps. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>The current mod of the MTS step (1, 2, or 3 here) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="MTS__LOOP_8f90_source.html#l00198">198</a> of file <a class="el" href="MTS__LOOP_8f90_source.html">MTS_LOOP.f90</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="MTS__LOOP_8f90_a6ced222833e8795eefde6ecaf016090a_icgraph.png" border="0" usemap="#MTS__LOOP_8f90_a6ced222833e8795eefde6ecaf016090a_icgraph" alt=""/></div>
<map name="MTS__LOOP_8f90_a6ced222833e8795eefde6ecaf016090a_icgraph" id="MTS__LOOP_8f90_a6ced222833e8795eefde6ecaf016090a_icgraph">
<area shape="rect" id="node2" href="MTS__LOOP_8f90.html#a7d4911a91ded9ca2f05f4884935c01b8" title="The force loop for MTS simulation. " alt="" coords="160,5,240,32"/><area shape="rect" id="node3" href="MTS__LOOP_8f90.html#a5673b4a1685b045fd9770235fb53776f" title="The alternate molecular dynamics loop for MTS simulations. " alt="" coords="288,5,363,32"/><area shape="rect" id="node4" href="main_8F90.html#aede99a747ff1a095c7edcbad1119411f" title="ibisco" alt="" coords="411,5,467,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4a33818f78ea9fe4fb159959e6428925"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mts_loadauxs </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>I</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Approximates the nonbonded potential and pressure tensors in approximate MTS steps. </p>

<p>Definition at line <a class="el" href="MTS__LOOP_8f90_source.html#l00221">221</a> of file <a class="el" href="MTS__LOOP_8f90_source.html">MTS_LOOP.f90</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="MTS__LOOP_8f90_a4a33818f78ea9fe4fb159959e6428925_icgraph.png" border="0" usemap="#MTS__LOOP_8f90_a4a33818f78ea9fe4fb159959e6428925_icgraph" alt=""/></div>
<map name="MTS__LOOP_8f90_a4a33818f78ea9fe4fb159959e6428925_icgraph" id="MTS__LOOP_8f90_a4a33818f78ea9fe4fb159959e6428925_icgraph">
<area shape="rect" id="node2" href="MTS__LOOP_8f90.html#a7d4911a91ded9ca2f05f4884935c01b8" title="The force loop for MTS simulation. " alt="" coords="157,5,237,32"/><area shape="rect" id="node3" href="MTS__LOOP_8f90.html#a5673b4a1685b045fd9770235fb53776f" title="The alternate molecular dynamics loop for MTS simulations. " alt="" coords="285,5,360,32"/><area shape="rect" id="node4" href="main_8F90.html#aede99a747ff1a095c7edcbad1119411f" title="ibisco" alt="" coords="408,5,464,32"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="MTS__LOOP_8f90.html">MTS_LOOP.f90</a></li>
    <li class="footer">Generated on Thu Jun 5 2014 11:52:45 for IBIsCO by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
